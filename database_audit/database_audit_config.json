{
  "audit_config": {
    "version": "1.0",
    "description": "Database audit configuration for VATSIM data collection system",
    "last_updated": "2025-01-27",
    "audit_types": {
      "full": {
        "description": "Complete audit including schema, performance, and data integrity",
        "enabled": true,
        "timeout_seconds": 300
      },
      "schema": {
        "description": "Schema-only audit focusing on field mappings and constraints",
        "enabled": true,
        "timeout_seconds": 120
      },
      "performance": {
        "description": "Performance-focused audit including indexes and query analysis",
        "enabled": true,
        "timeout_seconds": 180
      }
    }
  },
  "expected_schema": {
    "controllers": {
      "description": "ATC controller positions and data",
      "required_fields": [
        "id",
        "callsign",
        "facility",
        "position",
        "status",
        "frequency",
        "last_seen",
        "workload_score",
        "preferences",
        "controller_id",
        "controller_name",
        "controller_rating",
        "visual_range",
        "text_atis",
        "created_at",
        "updated_at"
      ],
      "vatsim_api_mapping": {
        "cid": "controller_id",
        "name": "controller_name",
        "rating": "controller_rating",
        "callsign": "callsign",
        "facility": "facility",
        "frequency": "frequency",
        "position": "position",
        "status": "status"
      },
      "indexes": [
        "idx_controllers_callsign",
        "idx_controllers_controller_id",
        "idx_controllers_visual_range"
      ],
      "constraints": {
        "unique": ["callsign"],
        "not_null": ["callsign", "facility"]
      },
      "data_types": {
        "id": "SERIAL",
        "callsign": "VARCHAR(50)",
        "facility": "VARCHAR(50)",
        "position": "VARCHAR(50)",
        "status": "VARCHAR(20)",
        "frequency": "VARCHAR(20)",
        "controller_id": "INTEGER",
        "controller_name": "VARCHAR(100)",
        "controller_rating": "INTEGER"
      }
    },
    "flights": {
      "description": "Flight tracking and position data",
      "required_fields": [
        "id",
        "callsign",
        "aircraft_type",
        "position_lat",
        "position_lng",
        "altitude",
        "heading",
        "groundspeed",
        "cruise_tas",
        "transponder",
        "departure",
        "arrival",
        "route",
        "status",
        "last_updated",
        "created_at",
        "updated_at",
        "cid",
        "name",
        "server",
        "pilot_rating",
        "military_rating",
        "latitude",
        "longitude",
        "qnh_i_hg",
        "qnh_mb",
        "logon_time",
        "last_updated_api"
      ],
      "vatsim_api_mapping": {
        "cid": "cid",
        "name": "name",
        "server": "server",
        "rating": "pilot_rating",
        "position.lat": "latitude",
        "position.lng": "longitude",
        "groundspeed": "groundspeed",
        "transponder": "transponder"
      },
      "indexes": [
        "idx_flights_callsign",
        "idx_flights_cid",
        "idx_flights_name",
        "idx_flights_server",
        "idx_flights_latitude",
        "idx_flights_longitude",
        "idx_flights_groundspeed",
        "idx_flights_transponder",
        "idx_flights_logon_time",
        "idx_flights_last_updated_api"
      ],
      "constraints": {
        "unique": [],
        "not_null": ["callsign"]
      },
      "data_types": {
        "id": "SERIAL",
        "callsign": "VARCHAR(50)",
        "aircraft_type": "VARCHAR(20)",
        "position_lat": "DOUBLE PRECISION",
        "position_lng": "DOUBLE PRECISION",
        "altitude": "INTEGER",
        "heading": "INTEGER",
        "groundspeed": "INTEGER",
        "transponder": "VARCHAR(10)",
        "cid": "INTEGER",
        "name": "VARCHAR(100)",
        "server": "VARCHAR(50)",
        "pilot_rating": "INTEGER",
        "latitude": "DOUBLE PRECISION",
        "longitude": "DOUBLE PRECISION"
      }
    },
    "transceivers": {
      "description": "Radio frequency and communication data",
      "required_fields": [
        "id",
        "callsign",
        "transceiver_id",
        "frequency",
        "position_lat",
        "position_lon",
        "height_msl",
        "height_agl",
        "entity_type",
        "entity_id",
        "timestamp",
        "updated_at"
      ],
      "vatsim_api_mapping": {
        "callsign": "callsign",
        "transceiver_id": "transceiver_id",
        "frequency": "frequency",
        "position_lat": "position_lat",
        "position_lon": "position_lon",
        "height_msl": "height_msl",
        "height_agl": "height_agl",
        "entity_type": "entity_type",
        "entity_id": "entity_id"
      },
      "indexes": [
        "idx_transceivers_callsign",
        "idx_transceivers_timestamp"
      ],
      "constraints": {
        "unique": [],
        "not_null": ["callsign", "transceiver_id", "frequency", "entity_type"]
      },
      "data_types": {
        "id": "SERIAL",
        "callsign": "VARCHAR(50)",
        "transceiver_id": "INTEGER",
        "frequency": "INTEGER",
        "position_lat": "DOUBLE PRECISION",
        "position_lon": "DOUBLE PRECISION",
        "height_msl": "DOUBLE PRECISION",
        "height_agl": "DOUBLE PRECISION",
        "entity_type": "VARCHAR(20)",
        "entity_id": "INTEGER"
      }
    },
    "airports": {
      "description": "Airport configuration and data",
      "required_fields": [
        "id",
        "icao_code",
        "name",
        "latitude",
        "longitude",
        "is_active",
        "created_at"
      ],
      "indexes": [
        "idx_airports_icao"
      ],
      "constraints": {
        "unique": ["icao_code"],
        "not_null": ["icao_code", "name"]
      },
      "data_types": {
        "id": "SERIAL",
        "icao_code": "VARCHAR(10)",
        "name": "VARCHAR(200)",
        "latitude": "DOUBLE PRECISION",
        "longitude": "DOUBLE PRECISION",
        "is_active": "BOOLEAN"
      }
    },
    "vatsim_status": {
      "description": "VATSIM network status and metrics",
      "required_fields": [
        "id",
        "api_version",
        "reload",
        "update_timestamp",
        "connected_clients",
        "unique_users",
        "created_at",
        "updated_at"
      ],
      "indexes": [
        "idx_vatsim_status_update_timestamp"
      ],
      "constraints": {
        "unique": [],
        "not_null": ["update_timestamp"]
      },
      "data_types": {
        "id": "SERIAL",
        "api_version": "INTEGER",
        "reload": "INTEGER",
        "update_timestamp": "TIMESTAMP",
        "connected_clients": "INTEGER",
        "unique_users": "INTEGER"
      }
    }
  },
  "validation_rules": {
    "field_mapping": {
      "strict_mode": true,
      "allow_extra_fields": false,
      "allow_missing_fields": false,
      "case_sensitive": true
    },
    "data_types": {
      "strict_mode": true,
      "allow_type_variations": false,
      "preferred_types": {
        "timestamps": "TIMESTAMP WITH TIME ZONE",
        "integers": "INTEGER",
        "decimals": "DECIMAL",
        "strings": "VARCHAR"
      }
    },
    "indexes": {
      "minimum_indexes_per_table": 2,
      "required_indexes": {
        "flights": ["idx_flights_callsign", "idx_flights_cid"],
        "controllers": ["idx_controllers_callsign", "idx_controllers_controller_id"],
        "transceivers": ["idx_transceivers_callsign", "idx_transceivers_timestamp"]
      }
    },
    "constraints": {
      "enforce_not_null": true,
      "enforce_unique": true,
      "enforce_foreign_keys": true
    },
    "performance": {
      "max_table_size_mb": 1000,
      "max_index_count": 25,
      "min_index_usage_ratio": 0.1,
      "max_slow_query_time_ms": 1000
    },
    "data_integrity": {
      "check_orphaned_records": true,
      "check_duplicate_records": true,
      "max_orphaned_records": 0,
      "max_duplicate_records": 0
    }
  },
  "audit_thresholds": {
    "pass": {
      "missing_fields": 0,
      "type_mismatches": 0,
      "missing_indexes": 0,
      "orphaned_records": 0,
      "duplicate_records": 0
    },
    "warn": {
      "missing_fields": 0,
      "type_mismatches": 2,
      "missing_indexes": 1,
      "orphaned_records": 10,
      "duplicate_records": 5
    },
    "fail": {
      "missing_fields": 1,
      "type_mismatches": 5,
      "missing_indexes": 3,
      "orphaned_records": 100,
      "duplicate_records": 50
    }
  },
  "performance_metrics": {
    "table_size_threshold_mb": 100,
    "index_usage_threshold": 0.05,
    "slow_query_threshold_ms": 500,
    "connection_pool_threshold": 0.8
  },
  "reporting": {
    "output_formats": ["json", "html", "markdown"],
    "include_performance_data": true,
    "include_recommendations": true,
    "include_field_details": true,
    "include_index_details": true,
    "include_constraint_details": true
  }
}
